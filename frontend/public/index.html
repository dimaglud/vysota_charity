<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="assets/site.css" />
  </head>
<body>
  <div class="container">
    <header>
      <a href="index.html" >
        <img class="logo" src="assets/img/logo.png" />
      </a>
      <div class="menu">
        <div class="menu-item">
          <a href="about.html">About Fund</a></div>
        <div class="menu-item">
          <a href="helpto.html">Who do we help?</a></div>
        <!--div class="menu-item">Проекти</div-->
        <div class="menu-item">
          <a href="partners.html">Partners</a>
        </div>  
      </div>
      <div class="lang">
        <div class="lang-item active">UA</div>  
        <div class="lang-item">EN</div>  
        <div class="lang-item">DE</div>  
      </div>
      <div class="participate">
        <a href="participate.html">Participate</a>
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 17 13" fill="none">
          <path d="M2.6627 6.50001C1.53151 5.36882 1.53151 3.5348 2.6627 2.40361C3.79389 1.27242 5.62791 1.27242 6.7591 2.40361L12.9037 8.54821L8.8073 12.6446L2.6627 6.50001Z" fill="white"/>
          <path d="M10.8554 2.40342C11.9866 1.27224 13.8206 1.27224 14.9518 2.40342C16.083 3.53461 16.083 5.36863 14.9518 6.49982L8.80716 12.6444L4.71076 8.54802L10.8554 2.40342Z" fill="white"/>
        </svg>
      </div>
    </header>

    <!--
    <div class="video">
      <div class="h1">
        Відео звернення засновника та інфо про фонд
      </div>
    </div>
    -->
    
    <div class="h1">
      Support our projects
      <a class="header-link" fref="#" >
        Більше проектів 
        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
          <line x1="11" y1="10.0166" x2="11" y2="0.0166016" stroke="#868686" stroke-width="2"/>
          <path d="M1.40137 10.6313L11.3009 0.731852" stroke="#868686" stroke-width="2"/>
          <line x1="12" y1="1.0166" x2="2" y2="1.0166" stroke="#868686" stroke-width="2"/>
          </svg>
      </a>
    </div>

    <!-- CURRENT PROJECTS -->
    <div id="current_projects"></div>
    
    <div class="h1">
      Implemented projects
      <a class="header-link" fref="#" >
        Більше проектів 
        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
          <line x1="11" y1="10.0166" x2="11" y2="0.0166016" stroke="#868686" stroke-width="2"/>
          <path d="M1.40137 10.6313L11.3009 0.731852" stroke="#868686" stroke-width="2"/>
          <line x1="12" y1="1.0166" x2="2" y2="1.0166" stroke="#868686" stroke-width="2"/>
          </svg>
      </a>
    </div>

    <!-- PASSED PROJECTS -->
    <div id="passed_projects"></div>

    <div class="h1">
      Special thanks to partners
    </div>
    <div>
      <table class="partners-table">
        <tr>
          <td><img src="assets/img/partners/chaos.png" /></td>
          <td><img src="assets/img/partners/hannah.png" /></td>
          <td><img src="assets/img/partners/julbo.png" /></td>
        </tr>
        <tr>
          <td><img src="assets/img/partners/lasportiva.png" /></td>
          <td><img src="assets/img/partners/lorpen.png" /></td>
          <td><img src="assets/img/partners/petzl.png" /></td>
        </tr>
      </table>
    </div>

    <div class="help-address">
      <div class="h1">Who do we help?</div>
      <div class="details">
        <div class="help-address_normal">
          <p>
            Athletes: Alpinists, rock climbers, trail runners, runners etc.
          </p>
          <p>
            Clubs: Mountaineering, climbing, trailrunning, triathlon etc. clubs
          </p>
          <p>
            Training spaces (climbing halls and other places for sport activities): Support to climbing halls, water equipment rental stations, athletics halls, cross-country ski schools, etc. whose facilities or material resources were damaged as a result of military operations or completely lost due to the occupation
          </p>
          <p>
            National teams: Support for National teams of all types (climbing, running, trailrunning etc.)
          </p>
          <p>
            Athlete's families: Support to relatieves of athletes who serve in Ukrainian army and/or were wounded at the battlefield or because of the war actions or died
          </p>
          <p>
            Shops: Support to dealers who lost their shops or part of equipment due to war 
          </p>
          <p>
            Competitions: Climbing, running, trail running, Nordic walking, cross-country skiing, alpine skiing or snowboarding, cycling competitions and cycling marathons. 
          </p>
        </div>
        <div>
          <a href="helpto.html" class="details-link">
            Details
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
              <line x1="10.8853" y1="10.4915" x2="10.8853" y2="0.491455" stroke="#D9D9D9" stroke-width="2"/>
              <path d="M1.28662 11.1062L11.1861 1.20671" stroke="#D9D9D9" stroke-width="2"/>
              <line x1="11.8853" y1="1.49146" x2="1.88525" y2="1.49146" stroke="#D9D9D9" stroke-width="2"/>
            </svg>
          </a>
        </div>  
      </div>
    </div>

    <div class="get-help">
      <div><a href="needhelp.html">How to get help?</a></div>
      <a href="needhelp.html" class="details-link">
        Details
        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
          <line x1="10.8853" y1="10.4915" x2="10.8853" y2="0.491455" stroke="#D9D9D9" stroke-width="2"/>
          <path d="M1.28662 11.1062L11.1861 1.20671" stroke="#D9D9D9" stroke-width="2"/>
          <line x1="11.8853" y1="1.49146" x2="1.88525" y2="1.49146" stroke="#D9D9D9" stroke-width="2"/>
        </svg>
      </a>
    </div>

    <footer>
      <img class="logo" src="assets/img/logo.png" />
  
      <div class="footer-menu-item">
        <div class="title">FUND</div>
        <div class="item"><a href="about.html">About us</a></div>
        <div class="item">Reporting</div>
        <div class="item"><a href="partners.html">Partners</a></div>
      </div>

      <div class="footer-menu-item">
        <div class="title">HELP</div>
        <div class="item"><a href="needhelp.html">How to get help</a></div>
        <div class="item">Current projects</div>
        <div class="item">Implemented projects</div>
      </div>

      <div class="footer-menu-item">
        <div class="title">CONTACTS</div>
        <div class="item"><a href="mailto:fund@vysota.com.ua">fund@vysota.com.ua</a></div>
        <div class="item"></div>
        <div class="item"></div>
      </div>
  
      <div class="participate">
        <a href="participate.html">Participate</a>
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 17 13" fill="none">
          <path d="M2.6627 6.50001C1.53151 5.36882 1.53151 3.5348 2.6627 2.40361C3.79389 1.27242 5.62791 1.27242 6.7591 2.40361L12.9037 8.54821L8.8073 12.6446L2.6627 6.50001Z" fill="white"/>
          <path d="M10.8554 2.40342C11.9866 1.27224 13.8206 1.27224 14.9518 2.40342C16.083 3.53461 16.083 5.36863 14.9518 6.49982L8.80716 12.6444L4.71076 8.54802L10.8554 2.40342Z" fill="white"/>
        </svg>
      </div>
    </footer>

  </div>

</body>


<!-- This setup is not suitable for production. -->
<!-- Only use it in development! -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script async src="https://ga.jspm.io/npm:es-module-shims@1.7.0/dist/es-module-shims.js"></script>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react?dev",
    "react-dom/client": "https://esm.sh/react-dom/client?dev"
  }
}
</script>
<script type="text/babel" data-type="module">
import React, { StrictMode, useState, useEffect } from 'react';
import { createRoot } from 'react-dom/client';

//const API_URL = "http://localhost:4000"
const API_URL = "/api"

function ProjectRow({ project, projectClass }) {
  return (
    <div class={ projectClass }>
      <img src={ API_URL + '/images/content/project/' + project.id } />
      <div>
        <div class="project-title">{project.title}</div>
        <div class="project-description" dangerouslySetInnerHTML={{__html: prepareParagraphs(project.description)}}></div>
        <div class="project-links">
          <a class="more-info" href={"project.html?id=" + project.id}>
            Details
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
              <line x1="10.7754" y1="10.6578" x2="10.7754" y2="0.657837" stroke="#008178" stroke-width="2"/>
              <path d="M1.177 11.2726L11.0765 1.37309" stroke="#008178" stroke-width="2"/>
              <line x1="11.7754" y1="1.65784" x2="1.77539" y2="1.65784" stroke="#008178" stroke-width="2"/>
            </svg>
          </a>
          <div class={ project.isActive ? "participate" : "hidden" }>
            <a href="participate.html">Participate</a>
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 17 13" fill="none">
              <path d="M2.6627 6.50001C1.53151 5.36882 1.53151 3.5348 2.6627 2.40361C3.79389 1.27242 5.62791 1.27242 6.7591 2.40361L12.9037 8.54821L8.8073 12.6446L2.6627 6.50001Z" fill="white"/>
              <path d="M10.8554 2.40342C11.9866 1.27224 13.8206 1.27224 14.9518 2.40342C16.083 3.53461 16.083 5.36863 14.9518 6.49982L8.80716 12.6444L4.71076 8.54802L10.8554 2.40342Z" fill="white"/>
            </svg>
          </div>
        </div>
      </div>
    </div>
  );
}

function ActiveProjectsList({ projects }) {
  const rows = [];
  projects.forEach((project) => {
    rows.push(
      <ProjectRow
        project={project} projectClass={ projects.length == 3 ? "project width-third" : projects.length == 2 ? "project width-half" : "project width-full" } />
    );
  });

  return (
    <div class="current-projects-list">
      {rows}
    </div>
  );
}

let CurrentProjects = function App() {
  const [activeProjects, setActiveProjects] = useState([]);
   useEffect(() => {
      fetch(API_URL + '/projects?isActive=true')
         .then((response) => response.json())
         .then((data) => {
            console.log(data);
            setActiveProjects(data);
         })
         .catch((err) => {
            console.log(err.message);
         });
   }, []);
   
   return <ActiveProjectsList projects={activeProjects} />;
}

function InactiveProjectsList({ projects }) {
  switch (projects.length) {
    case 0: return <div class="current-projects-list"></div>
    break;
    case 1: return (
      <div class="current-projects-list">
        <ProjectRow project={ projects[0] } projectClass="project width-full" />
      </div>
    )
    break;
    case 2: return (
      <div class="current-projects-list">
        <ProjectRow project={ projects[0] } projectClass="project width-half" />
        <div class="width-half">
          <ProjectRow project={ projects[1] } projectClass="project" />
        </div>
      </div>
    )
    break;
    case 3: return (
      <div class="current-projects-list">
        <ProjectRow project={ projects[0] } projectClass="project width-half" />
        <div class="width-half">
          <ProjectRow project={ projects[1] } projectClass="project-small" />
          <ProjectRow project={ projects[2] } projectClass="project-small" />
        </div>
      </div>
    )
    break;
  }
}

let PassedProjects = function Passed() {
  const [inactiveProjects, setInactiveProjects] = useState([]);
   useEffect(() => {
      fetch(API_URL + '/projects?isActive=false')
         .then((response) => response.json())
         .then((data) => {
            console.log(data);
            setInactiveProjects(data);
         })
         .catch((err) => {
            console.log(err.message);
         });
   }, []);
   
   return <InactiveProjectsList projects={inactiveProjects} />;
}

function prepareParagraphs(text) {
  return trim(text.replaceAll("\n", "<br>"), 200);
}

function trim(text, length) {
  if (text.length < length)
    return text;

  const index = text.indexOf(" ", length);
  return text.substring(0, index) + "...";
}

const currentProjects = createRoot(document.getElementById('current_projects'));
currentProjects.render(
  <StrictMode>
    <CurrentProjects />
  </StrictMode>
);

const passedProjects = createRoot(document.getElementById('passed_projects'));
passedProjects.render(
  <StrictMode>
    <PassedProjects />
  </StrictMode>
);

</script>

</html>